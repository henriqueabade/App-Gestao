<div id="converterOrcamentoOverlay" class="fixed inset-0 bg-black/50 flex items-center justify-center p-4 z-[1003]">
  <div role="dialog" aria-modal="true" tabindex="0" class="w-full max-w-7xl max-h-[95vh] bg-surface/60 backdrop-blur-xl rounded-3xl border border-white/10 ring-1 ring-white/5 shadow-2xl/40 animate-modalFade slide-in overflow-hidden flex flex-col">
    <header class="flex flex-wrap items-center justify-between gap-4 px-8 py-5 border-b border-white/10 flex-shrink-0">
      <div>
        <h2 class="text-xl font-semibold text-white">REVISAR CONVERSÃO DE ORÇAMENTO</h2>
        <p id="converterOrcamentoSubtitulo" class="text-gray-300 text-sm"></p>
      </div>
      <div class="flex items-center gap-3">
        <button id="voltarConverterOrcamento" class="btn-danger px-4 py-2 rounded-lg text-white font-medium">Cancelar</button>
        <button id="confirmarConverterOrcamento" class="btn-primary px-5 py-2 rounded-lg text-white font-medium opacity-60 cursor-not-allowed" disabled>Confirmar Conversão</button>
      </div>
    </header>

    <div id="converterWarning" class="px-8 py-3 bg-red-500/10 border-b border-red-500/20 flex-shrink-0 hidden">
      <div class="flex items-center gap-3">
        <span class="text-red-400">⚠</span>
        <span id="converterWarningText" class="text-red-300 font-medium text-sm"></span>
      </div>
    </div>

    <div class="px-8 py-4 border-b border-white/10 flex-shrink-0">
      <div class="flex flex-wrap gap-3">
        <span id="chipTotalPecas" class="badge-info px-3 py-1 rounded-full text-xs font-medium">0 Peças Orçadas</span>
        <span id="chipEmEstoque" class="badge-success px-3 py-1 rounded-full text-xs font-medium">0 Em Estoque</span>
        <span id="chipAProduzir" class="badge-warning px-3 py-1 rounded-full text-xs font-medium">0 A Produzir</span>
      </div>
    </div>

    <div class="flex-1 overflow-y-auto modal-scroll">
      <div class="p-8">
        <div class="grid grid-cols-1 gap-8">
          <div class="w-full bg-surface/40 rounded-2xl border border-white/10 p-6">
            <h3 class="text-lg font-semibold text-white mb-4">Peças</h3>
            <div class="table-scroll">
              <table class="w-full text-sm">
                <thead>
                  <tr class="border-b border-white/10">
                    <th class="text-left py-3 px-2 text-gray-300 font-medium whitespace-nowrap">Peça</th>
                    <th class="text-center py-3 px-2 text-gray-300 font-medium whitespace-nowrap">Qtd Orçada</th>
                    <th class="text-center py-3 px-2 text-gray-300 font-medium whitespace-nowrap">Em Estoque</th>
                    <th class="text-center py-3 px-2 text-gray-300 font-medium whitespace-nowrap">Pronta</th>
                    <th class="text-center py-3 px-2 text-gray-300 font-medium whitespace-nowrap">Produzir Total</th>
                    <th class="text-center py-3 px-2 text-gray-300 font-medium whitespace-nowrap">Produzir Parcial</th>
                    <th class="text-center py-3 px-2 text-gray-300 font-medium whitespace-nowrap">Status</th>
                    <th class="text-center py-3 px-2 text-gray-300 font-medium whitespace-nowrap">Ações</th>
                  </tr>
                </thead>
                <tbody id="converterPecasBody"></tbody>
              </table>
            </div>
            <div class="mt-4 pt-4 border-t border-white/10 flex justify-between text-sm">
              <span class="text-gray-400">Total validado:</span>
              <span id="converterPecasTotal" class="text-white font-medium">0/0 peças</span>
            </div>
          </div>

          <div class="w-full bg-surface/40 rounded-2xl border border-white/10 p-6">
            <div class="flex items-center justify-between mb-4">
              <h3 class="text-lg font-semibold text-white">Insumos: <span id="insumosTituloPeca" class="text-gray-200">Totais</span></h3>
              <div class="flex items-center gap-4">
                <label class="flex items-center gap-3 text-sm text-gray-200 select-none">
                  <input id="onlyMissingToggle" type="checkbox" class="component-toggle" checked />
                  Somente faltantes
                </label>
                <button class="btn-neutral px-3 py-1 rounded text-sm flex items-center gap-2" data-action="insumos-reload" title="Recarregar insumos (totais)">
                  <i class="fas fa-sync-alt"></i>
                  Reload
                </button>
              </div>
            </div>
            <div class="table-scroll">
              <table class="w-full text-sm">
                <thead>
                  <tr class="border-b border-white/10">
                    <th class="text-left py-3 px-2 text-gray-300 font-medium">Insumo</th>
                    <th class="text-center py-3 px-2 text-gray-300 font-medium">Unidade</th>
                    <th class="text-center py-3 px-2 text-gray-300 font-medium">Disponível</th>
                    <th class="text-center py-3 px-2 text-gray-300 font-medium">Necessário</th>
                    <th class="text-center py-3 px-2 text-gray-300 font-medium">Saldo (prev.)</th>
                    <th class="text-center py-3 px-2 text-gray-300 font-medium">Etapa</th>
                    <th class="text-center py-3 px-2 text-gray-300 font-medium">Flags</th>
                  </tr>
                </thead>
                <tbody id="converterInsumosBody"></tbody>
              </table>
            </div>
            <div class="mt-6">
              <label class="block text-sm font-medium text-gray-300 mb-2">Nota de decisão para saldo negativo</label>
              <textarea id="converterDecisionNote" rows="3" placeholder="Justifique a decisão para insumos com saldo negativo..." class="w-full bg-input border border-inputBorder rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-primary focus:ring-2 focus:ring-primary/50 transition resize-none"></textarea>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
</div>
