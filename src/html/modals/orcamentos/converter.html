<div id="converterOrcamentoOverlay" class="fixed inset-0 z-[2001] bg-black/50 flex items-center justify-center p-4">
  <div role="dialog" aria-modal="true" tabindex="0" class="w-full max-w-7xl max-h-[95vh] glass-surface backdrop-blur-xl rounded-3xl border border-white/10 ring-1 ring-white/5 shadow-2xl/40 animate-modalFade slide-in overflow-hidden flex flex-col">

    <!-- Header -->
    <header class="flex items-center justify-between px-8 py-5 border-b border-white/10 flex-shrink-0">
      <div>
        <h2 class="text-2xl font-bold text-white mb-1">Revisar conversão de orçamento</h2>
        <p id="convHeaderInfo" class="text-gray-300 text-sm"></p>
      </div>
      <button id="fecharConverterOrcamento" class="btn-neutral px-4 py-2 rounded-lg text-white font-medium">✕</button>
    </header>

    <!-- Status Summary -->
    <div class="px-8 py-4 border-b border-white/10 flex-shrink-0">
      <div class="flex flex-wrap gap-3">
        <span id="convResumoTotal" class="badge-info px-3 py-1 rounded-full text-sm font-medium">0 Peças Orçadas</span>
        <span id="convResumoEstoque" class="badge-success px-3 py-1 rounded-full text-sm font-medium">0 Em Estoque</span>
        <span id="convResumoProduzir" class="badge-warning px-3 py-1 rounded-full text-sm font-medium">0 A Produzir</span>
      </div>
    </div>

    <!-- Warning Banner -->
    <div id="convWarning" class="px-8 py-3 bg-red-500/10 border-b border-red-500/20 flex-shrink-0 hidden">
      <div class="flex items-center gap-3">
        <span class="text-red-400">⚠️</span>
        <span id="convWarningText" class="text-red-300 font-medium">Ajustes necessários antes de confirmar</span>
      </div>
    </div>

    <!-- Content -->
    <div class="flex-1 overflow-y-auto modal-scroll">
      <div class="p-8">
        <div class="grid grid-cols-1 xl:grid-cols-2 gap-8">
          <!-- Peças -->
          <div class="bg-surface/40 rounded-2xl border border-white/10 p-6">
            <h3 class="text-lg font-semibold text-white mb-4">Peças</h3>
            <div class="table-scroll">
              <table class="w-full text-sm">
                <thead class="bg-surface/60 backdrop-blur-sm">
                  <tr class="border-b border-white/10">
                    <th class="text-left py-3 px-3 text-gray-300 font-medium">Peça</th>
                    <th class="text-center py-3 px-3 text-gray-300 font-medium">Qtd Orçada</th>
                    <th class="text-center py-3 px-3 text-gray-300 font-medium">Em Estoque</th>
                    <th class="text-center py-3 px-3 text-gray-300 font-medium">A Produzir</th>
                    <th class="text-center py-3 px-3 text-gray-300 font-medium">Status</th>
                    <th class="text-center py-3 px-3 text-gray-300 font-medium">Ações</th>
                  </tr>
                </thead>
                <tbody id="convPiecesBody"></tbody>
              </table>
            </div>
            <div class="mt-4 pt-4 border-t border-white/10">
              <div class="flex justify-between text-sm">
                <span class="text-gray-400">Total validado:</span>
                <span id="convPiecesCounter" class="text-white font-medium">0/0 peças</span>
              </div>
            </div>
          </div>

          <!-- Insumos -->
          <div class="bg-surface/40 rounded-2xl border border-white/10 p-6">
            <h3 class="text-lg font-semibold text-white mb-4">Insumos</h3>
            <div class="table-scroll">
              <table class="w-full text-sm">
                <thead class="bg-surface/60 backdrop-blur-sm">
                  <tr class="border-b border-white/10">
                    <th class="text-left py-3 px-3 text-gray-300 font-medium">Insumo</th>
                    <th class="text-center py-3 px-3 text-gray-300 font-medium">Unidade</th>
                    <th class="text-center py-3 px-3 text-gray-300 font-medium">Disponível</th>
                    <th class="text-center py-3 px-3 text-gray-300 font-medium">Previsto</th>
                    <th class="text-center py-3 px-3 text-gray-300 font-medium">Saldo</th>
                  </tr>
                </thead>
                <tbody id="convInsumosBody"></tbody>
              </table>
            </div>
            <div class="mt-6">
              <label class="block text-sm font-medium text-gray-300 mb-2">Nota de decisão para saldo negativo</label>
              <textarea id="convDecisionNote" rows="3" placeholder="Justifique a decisão para insumos com saldo negativo..." class="w-full bg-input border border-inputBorder rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-primary focus:ring-2 focus:ring-primary/50 transition resize-none"></textarea>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="flex justify-end items-center gap-4 px-8 py-6 border-t border-white/10 flex-shrink-0">
      <button id="convCancelar" class="btn-neutral px-6 py-3 rounded-lg text-white font-medium">Cancelar</button>
      <button id="convConfirmar" class="btn-primary px-6 py-3 rounded-lg text-white font-medium opacity-50 cursor-not-allowed" disabled>Confirmar conversão</button>
    </footer>
  </div>

  <!-- Replace Drawer -->
  <div id="convReplaceDrawer" class="hidden fixed inset-0 z-[2002]">
    <div class="absolute inset-0 bg-black/50" data-close-drawer></div>
    <div class="drawer absolute right-0 top-0 h-full w-full max-w-md glass-surface backdrop-blur-xl border-l border-white/10">
      <div class="flex flex-col h-full">
        <header class="flex items-center justify-between px-6 py-4 border-b border-white/10">
          <h3 class="text-lg font-semibold text-white">Substituir Peça</h3>
          <button id="convCloseDrawer" class="btn-neutral px-3 py-1 rounded-lg text-white">✕</button>
        </header>
        <div class="flex-1 overflow-y-auto p-6">
          <p class="text-gray-300 mb-2">Substituindo: <span id="convReplacingName" class="text-white font-medium"></span></p>
          <input id="convSearchReplace" type="text" placeholder="Buscar peças compatíveis..." class="w-full bg-input border border-inputBorder rounded-lg px-4 py-3 text-white placeholder-gray-400 focus:border-primary focus:ring-2 focus:ring-primary/50 transition mb-4" />
          <div id="convReplaceList" class="space-y-3"></div>
        </div>
      </div>
    </div>
  </div>
</div>

