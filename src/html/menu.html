<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta
        http-equiv="Content-Security-Policy"
        content="default-src 'self'; script-src 'self' 'unsafe-inline' https://cdn.jsdelivr.net https://cdnjs.cloudflare.com; style-src 'self' 'unsafe-inline' https://cdnjs.cloudflare.com https://fonts.googleapis.com; img-src 'self' data: blob: file: https: http:; font-src 'self' data: https://fonts.gstatic.com https://cdnjs.cloudflare.com; connect-src 'self' http://localhost:3000 https:; frame-ancestors 'none';"
    />
    <title>Santíssimo Decor - Dashboard</title>
    <link rel="stylesheet" href="../styles/tailwind-offline.css" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <!-- Estilos específicos do menu -->
    <link rel="stylesheet" href="../css/menu.css">
    <link rel="stylesheet" href="../styles/warning.css">
    <script src="../components/dialogPadrao.js"></script>
    <!-- Regras globais de seleção e arraste -->
    <link rel="stylesheet" href="../styles/restricoes.css">
    <!-- Estilos globais para barras de rolagem -->
    <link rel="stylesheet" href="../styles/scroll.css">
</head>
<body class="text-white">
    <!-- Topbar -->
    <header class="fixed top-0 left-0 right-0 z-[1001] h-14 glass-surface border-b border-white/10">
        <div class="flex items-center justify-between h-full px-4">
            <!-- Logo and Menu Toggle -->
            <div class="flex items-center">
                <div id="logoContainer" class="flex items-center">
                    <img src="../assets/Logo SideBar.png" alt="Santíssimo Decor" class="w-10 h-10" />
                    <span id="companyName" class="text-lg font-semibold ml-2 collapsed" style="color: var(--color-primary)">Santíssimo Decor</span>
                </div>
                <button id="menuToggle" class="ml-4 p-2 rounded-lg transition-colors duration-150 hover:bg-white/10">
                    <i class="fas fa-bars w-5 h-5" style="color: var(--color-primary)"></i>
                </button>
            </div>

            <!-- User Info & Actions -->
            <div class="flex items-center space-x-2">
                <div id="appUpdateContainer" class="app-update-container hidden" aria-live="polite">
                    <div class="app-update-actions">
                        <div id="supAdminUpdateControl" class="sup-admin-updates hidden">
                            <button
                                id="supAdminUpdatesTrigger"
                                type="button"
                                class="sup-admin-updates-trigger"
                                data-state="idle"
                                aria-expanded="false"
                                aria-haspopup="true"
                            >
                                <i id="supAdminUpdatesIcon" class="fas fa-cloud-upload-alt sup-admin-updates-icon" aria-hidden="true"></i>
                                <span id="supAdminUpdatesLabel">Atualizações</span>
                            </button>
                            <div
                                id="supAdminUpdatesPanel"
                                class="sup-admin-updates-panel hidden"
                                role="region"
                                aria-hidden="true"
                            >
                                <div
                                    id="supAdminUpdatesSummary"
                                    class="updates-summary"
                                    aria-live="polite"
                                ></div>
                                <button
                                    id="supAdminPublishAction"
                                    type="button"
                                    class="sup-admin-publish-action"
                                >
                                    <i id="supAdminPublishIcon" class="fas fa-cloud-upload-alt" aria-hidden="true"></i>
                                    <span id="supAdminPublishLabel">Publicar atualização</span>
                                </button>
                            </div>
                        </div>
                        <div id="userUpdateControl" class="user-updates hidden">
                            <button
                                id="userUpdatesTrigger"
                                type="button"
                                class="user-updates-trigger"
                                data-state="idle"
                                aria-expanded="false"
                                aria-haspopup="true"
                            >
                                <i id="userUpdatesIcon" class="fas fa-circle-check user-updates-icon" aria-hidden="true"></i>
                                <span id="userUpdatesLabel">Atualizações</span>
                            </button>
                            <div
                                id="userUpdatesPanel"
                                class="user-updates-panel hidden"
                                role="region"
                                aria-hidden="true"
                            >
                                <div
                                    id="userUpdatesSummary"
                                    class="updates-summary"
                                    aria-live="polite"
                                ></div>
                                <button id="userUpdateAction" type="button" class="user-update-action">
                                    <i id="userUpdateActionIcon" class="fas fa-cloud-download-alt" aria-hidden="true"></i>
                                    <span id="userUpdateActionLabel">Aplicar atualização</span>
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="flex items-center space-x-2" id="userIdentity" aria-live="polite">
                    <button
                        id="userAvatar"
                        type="button"
                        class="user-avatar hidden user-identity-trigger"
                        aria-controls="configuracoesModule"
                        aria-label="Abrir configurações de dados pessoais"
                        aria-hidden="true"
                    ></button>
                    <button
                        id="userSummary"
                        type="button"
                        class="user-summary-button user-identity-trigger"
                        aria-controls="configuracoesModule"
                        aria-live="polite"
                    >
                        <span id="userName" class="text-sm font-medium"></span>
                        <span id="userProfile" class="text-xs" style="color: var(--color-violet)"></span>
                    </button>
                </div>

                <div class="flex items-center space-x-2 relative">
                    <button id="user-actions-btn" class="p-2 rounded-lg transition-colors duration-150 hover:bg-white/10" style="color: var(--color-violet)" onmouseover="this.style.color='var(--color-primary-light)'" onmouseout="this.style.color='var(--color-violet)'">
                        <i class="fas fa-cog w-5 h-5"></i>
                    </button>
                    <div id="user-actions-menu" class="hidden absolute right-0 top-full mt-2 w-40 bg-white rounded-md shadow-lg z-[1010] text-sm text-gray-700">
                        <button data-action="logout" class="flex items-center w-full px-3 py-2 rounded-md hover:bg-[rgba(182,160,62,0.05)] hover:text-[#b6a03e]">
                            <i class="fas fa-sign-out-alt w-5 h-5 mr-2"></i>Sair
                        </button>
                        <button data-action="minimize" class="flex items-center w-full px-3 py-2 hover:bg-[rgba(182,160,62,0.05)] hover:text-[#b6a03e]">
                            <i class="fas fa-window-minimize w-5 h-5 mr-2"></i>Minimizar
                        </button>
                        <button data-action="reload" class="flex items-center w-full px-3 py-2 hover:bg-[rgba(182,160,62,0.05)] hover:text-[#b6a03e]">
                            <i class="fas fa-sync-alt w-5 h-5 mr-2"></i>Recarregar
                        </button>
                        <button data-action="select-display" class="flex items-center w-full px-3 py-2 hover:bg-[rgba(182,160,62,0.05)] hover:text-[#b6a03e]">
                            <i data-feather="monitor" class="w-5 h-5 mr-2"></i>Mudar de Tela
                        </button>
                        <button data-action="close" class="flex items-center w-full px-3 py-2 rounded-md hover:bg-[rgba(182,160,62,0.05)] hover:text-[#b6a03e]">
                            <i class="fas fa-times w-5 h-5 mr-2"></i>Fechar
                        </button>
                    </div>
                
                    <button id="networkCheck" class="p-2 rounded-lg transition-colors duration-150 hover:bg-white/10" style="color: var(--color-blue)">
                        <i class="fas fa-sync-alt w-4 h-4 rotating"></i>
                    </button>

                    <button id="notificationBtn" class="p-2 rounded-lg transition-colors duration-150 hover:bg-white/10 relative" style="color: white" onmouseover="this.style.color='var(--color-primary-light)'" onmouseout="updateNotificationColor()">
                        <i class="fas fa-bell w-5 h-5"></i>
                        <span id="notificationBadge" class="hidden absolute -top-1 -right-1 w-3 h-3 rounded-full" style="background: var(--color-red)"></span>
                    </button>
                </div>
            </div>
        </div>
    </header>

    <!-- Sidebar -->
    <aside id="sidebar" class="fixed left-0 top-14 bottom-0 sidebar-collapsed glass-deep border-r border-white/10 z-40 transition-all duration-200">
        <!-- Marca removida da sidebar -->
        <nav class="p-2 space-y-1">
            <!-- Dashboard -->
            <div class="sidebar-item active flex items-center p-3 rounded-lg" data-page="dashboard">
                <i class="fas fa-chart-line w-5 h-5 flex-shrink-0"></i>
                <span class="sidebar-text ml-3 whitespace-nowrap">Dashboard</span>
            </div>

            <!-- Matéria Prima -->
            <div class="sidebar-item flex items-center p-3 rounded-lg" data-page="materia-prima">
                <i class="fas fa-boxes w-5 h-5 flex-shrink-0"></i>
                <span class="sidebar-text ml-3 whitespace-nowrap">Matéria Prima</span>
            </div>

            <!-- Produtos -->
            <div class="sidebar-item flex items-center p-3 rounded-lg" data-page="produtos">
                <i class="fas fa-cube w-5 h-5 flex-shrink-0"></i>
                <span class="sidebar-text ml-3 whitespace-nowrap">Produtos</span>
            </div>

            <!-- Orçamentos -->
            <div class="sidebar-item flex items-center p-3 rounded-lg" data-page="orcamentos">
                <i class="fas fa-file-invoice-dollar w-5 h-5 flex-shrink-0"></i>
                <span class="sidebar-text ml-3 whitespace-nowrap">Orçamentos</span>
            </div>

            <!-- Pedidos -->
            <div class="sidebar-item flex items-center p-3 rounded-lg" data-page="pedidos">
                <i class="fas fa-shopping-cart w-5 h-5 flex-shrink-0"></i>
                <span class="sidebar-text ml-3 whitespace-nowrap">Pedidos</span>
            </div>

            <!-- CRM -->
            <div class="sidebar-item flex items-center justify-between p-3 rounded-lg" id="crmToggle">
                <div class="flex items-center">
                    <i class="fas fa-users w-5 h-5 flex-shrink-0"></i>
                    <span class="sidebar-text ml-3 whitespace-nowrap">CRM</span>
                </div>
                <i class="fas fa-chevron-right w-3 h-3 chevron sidebar-text"></i>
            </div>

            <!-- CRM Submenu -->
            <div class="submenu" id="crmSubmenu">
                <div class="submenu-item flex items-center py-2 px-3 rounded-lg" data-page="clientes">
                    <i class="fas fa-user-friends w-4 h-4 flex-shrink-0"></i>
                    <span class="sidebar-text ml-3 whitespace-nowrap">Clientes</span>
                </div>
                <div class="submenu-item flex items-center py-2 px-3 rounded-lg" data-page="prospeccoes">
                    <i class="fas fa-user-plus w-4 h-4 flex-shrink-0"></i>
                    <span class="sidebar-text ml-3 whitespace-nowrap">Prospecções</span>
                </div>
                <div class="submenu-item flex items-center py-2 px-3 rounded-lg" data-page="contatos">
                    <i class="fas fa-address-book w-4 h-4 flex-shrink-0"></i>
                    <span class="sidebar-text ml-3 whitespace-nowrap">Contatos</span>
                </div>
                <div class="submenu-item flex items-center py-2 px-3 rounded-lg" data-page="calendario">
                    <i class="fas fa-calendar-alt w-4 h-4 flex-shrink-0"></i>
                    <span class="sidebar-text ml-3 whitespace-nowrap">Calendário</span>
                </div>
                <div class="submenu-item flex items-center py-2 px-3 rounded-lg" data-page="tarefas">
                    <i class="fas fa-tasks w-4 h-4 flex-shrink-0"></i>
                    <span class="sidebar-text ml-3 whitespace-nowrap">Tarefas</span>
                </div>
            </div>

            <!-- Laminação -->
            <div class="sidebar-item flex items-center justify-between p-3 rounded-lg" id="laminacaoToggle">
                <div class="flex items-center">
                    <i class="fas fa-layer-group w-5 h-5 flex-shrink-0"></i>
                    <span class="sidebar-text ml-3 whitespace-nowrap">Laminação</span>
                </div>
                <i class="fas fa-chevron-right w-3 h-3 chevron sidebar-text"></i>
            </div>

            <!-- Laminação Submenu -->
            <div class="submenu" id="laminacaoSubmenu">
                <div class="submenu-item flex items-center py-2 px-3 rounded-lg" data-page="laminacao-clientes">
                    <i class="fas fa-user-friends w-4 h-4 flex-shrink-0"></i>
                    <span class="sidebar-text ml-3 whitespace-nowrap">Clientes</span>
                </div>
                <div class="submenu-item flex items-center py-2 px-3 rounded-lg" data-page="laminacao-servicos">
                    <i class="fas fa-concierge-bell w-4 h-4 flex-shrink-0"></i>
                    <span class="sidebar-text ml-3 whitespace-nowrap">Serviços</span>
                </div>
                <div class="submenu-item flex items-center py-2 px-3 rounded-lg" data-page="laminacao-precificacao">
                    <i class="fas fa-tags w-4 h-4 flex-shrink-0"></i>
                    <span class="sidebar-text ml-3 whitespace-nowrap">Precificação</span>
                </div>
                <div class="submenu-item flex items-center py-2 px-3 rounded-lg" data-page="laminacao-relatorios">
                    <i class="fas fa-chart-bar w-4 h-4 flex-shrink-0"></i>
                    <span class="sidebar-text ml-3 whitespace-nowrap">Relatórios</span>
                </div>
            </div>

            <!-- IA -->
            <div class="sidebar-item flex items-center p-3 rounded-lg" data-page="ia">
                <i class="fas fa-robot w-5 h-5 flex-shrink-0"></i>
                <span class="sidebar-text ml-3 whitespace-nowrap">IA</span>
            </div>

            <!-- Usuários -->
            <div class="sidebar-item flex items-center p-3 rounded-lg" data-page="usuarios">
                <i class="fas fa-user-shield w-5 h-5 flex-shrink-0"></i>
                <span class="sidebar-text ml-3 whitespace-nowrap">Usuários</span>
            </div>

            <!-- Financeiro -->
            <div class="sidebar-item flex items-center p-3 rounded-lg" data-page="financeiro">
                <i class="fas fa-hand-holding-usd w-5 h-5 flex-shrink-0"></i>
                <span class="sidebar-text ml-3 whitespace-nowrap">Financeiro</span>
            </div>

            <!-- Relatórios -->
            <div class="sidebar-item flex items-center p-3 rounded-lg" data-page="relatorios">
                <i class="fas fa-chart-bar w-5 h-5 flex-shrink-0"></i>
                <span class="sidebar-text ml-3 whitespace-nowrap">Relatórios</span>
            </div>

            <!-- Configurações -->
            <div class="sidebar-item flex items-center p-3 rounded-lg" data-page="configuracoes">
                <i class="fas fa-cogs w-5 h-5 flex-shrink-0"></i>
                <span class="sidebar-text ml-3 whitespace-nowrap">Configurações</span>
            </div>
        </nav>
    </aside>

    <!-- Main Content -->
        <main id="mainContent" class="transition-all duration-300 ml-16 mt-14 p-6">
         <div id="content" class="scroll-wrapper">
            <div class="modulo-container flex flex-col items-center justify-center py-24 text-center space-y-6">
                <div class="w-12 h-12 border-4 border-white/10 border-t-[var(--color-primary)] rounded-full animate-spin"></div>
                <div>
                    <p class="text-lg font-semibold text-white">Carregando Dashboard</p>
                    <p class="text-sm" style="color: var(--color-violet)">Preparando visão geral do Santíssimo Decor...</p>
                </div>
            </div>
        </div>
    </main>
    <div id="exitOverlay" class="hidden fixed inset-0 bg-[#3d021f] opacity-0 flex items-center justify-center z-50"></div>

    <!-- Script de controle do menu -->
    <script src="../utils/modal.js"></script>
    <script src="../utils/colorParser.js"></script>
    <script src="../utils/colors.js"></script>
    <script src="../utils/activityTracker.js"></script>
    <script src="../js/apiConfig.js"></script>
    <script src="../js/utils/date-key.js"></script>
    <script src="../js/utils/daily-run.js"></script>
    <script src="../js/utils/notifications.js"></script>
    <script src="../js/utils/date-range-filter.js"></script>
    <script src="../js/notifications.js"></script>
    <script src="../js/menu.js"></script>
    <script src="../js/auth/session.js"></script>
    <script src="../utils/userActions.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/feather-icons/dist/feather.min.js"></script>
    <script>
      feather.replace({ class: 'w-5 h-5' });
    </script>
    <script src="../js/checking.js"></script>
</body>
</html>
